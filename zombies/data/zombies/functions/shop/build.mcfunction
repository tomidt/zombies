###as @e[aoe] at @s
setblock ~ ~ ~ minecraft:white_concrete
setblock ~ ~1 ~ minecraft:white_stained_glass
setblock ~ ~2 ~ minecraft:white_carpet
setblock ~ ~-4 ~ command_block[facing=down]{Command:"execute positioned ~ ~4 ~ as @e[type=minecraft:area_effect_cloud,tag=shop,distance=..1,limit=1] at @s run function zombies:shop/update"} replace
setblock ~ ~-3 ~ command_block[facing=up]{Command:"setblock ~ ~1 ~ minecraft:air"} replace
setblock ~ ~-2 ~ minecraft:air
setblock ~ ~-1 ~ barrel[facing=up]{Items:[{Slot:0b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:1b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:2b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:3b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:4b,id:"minecraft:oak_sign",Count:1b,tag:{display:{Name:'{"text":"Item","italic":false}'},BlockEntityTag:{Color:"-1"}}},{Slot:5b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:6b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:7b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:8b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:9b,id:"minecraft:white_stained_glass_pane",Count:1b},{Slot:10b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:11b,id:"minecraft:white_stained_glass_pane",Count:1b},{Slot:12b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:13b,id:"minecraft:white_stained_glass_pane",Count:1b},{Slot:14b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:15b,id:"minecraft:white_stained_glass_pane",Count:1b},{Slot:16b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:17b,id:"minecraft:white_stained_glass_pane",Count:1b},{Slot:18b,id:"minecraft:paper",Count:1b,tag:{display:{Name:'{"text":"Set Cost","color":"gold","italic":false}',Lore:['[{"text":"Place [","color":"gray","italic":false},{"text":"Emeralds","color":"green"},{"text":"] in slot to set price","color":"gray"}]','[{"text":"Cost is taken from scoreboard [","color":"gray","italic":false},{"text":"points","color":"gold"},{"text":"]","color":"gray"}]']}}},{Slot:19b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:20b,id:"minecraft:paper",Count:1b,tag:{display:{Name:'{"text":"Set Item","color":"gold","italic":false}',Lore:['[{"text":"Place [","color":"gray","italic":false},{"text":"Item","color":"blue"},{"text":"] in slot to set item","color":"gray"}]','{"text":"Both stackable and nonstackable items are allowed","color":"gray","italic":false}']}}},{Slot:21b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:22b,id:"minecraft:paper",Count:1b,tag:{display:{Name:'{"text":"Set Uses","color":"gold","italic":false}',Lore:['[{"text":"Place [","color":"gray","italic":false},{"text":"Diamonds","color":"aqua"},{"text":"] in slot to set number of uses","color":"gray"}]','{"text":"Leave slot empty to allow for unlimited uses","color":"gray","italic":false}']}}},{Slot:23b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:24b,id:"minecraft:paper",Count:1b,tag:{display:{Name:'{"text":"Toggle Range","color":"gold","italic":false}',Lore:['[{"text":"Place [","color":"gray","italic":false},{"text":"Redstone","color":"red"},{"text":"] in slot to enable increased range","color":"gray"}]','[{"text":"Default range is [","color":"gray","italic":false},{"text":"2","color":"red"},{"text":"] blocks"}]','[{"text":"Increased range is [","color":"gray","italic":false},{"text":"5","color":"red"},{"text":"] blocks","color":"gray"}]']}}},{Slot:25b,id:"minecraft:black_stained_glass_pane",Count:1b,tag:{display:{Name:'{"text":" "}'}}},{Slot:26b,id:"minecraft:paper",Count:1b,tag:{display:{Name:'{"text":"Toggle Redstone Output","color":"gold","italic":false}',Lore:['[{"text":"Place [","color":"gray","italic":false},{"text":"Redstone","color":"red"},{"text":"] in slot to enable a redstone output","color":"gray"}]','{"text":"Output is sent 1 block below the barrel","color":"gray","italic":false}']}}}]} replace

scoreboard players set @s _points 0
scoreboard players set @s _output 0
scoreboard players set @s _range 0
scoreboard players set @s _use 0
scoreboard players set @s _currentuse 0

tag @s remove build
tellraw @p {"text":"Shop placed","color":"gray"}